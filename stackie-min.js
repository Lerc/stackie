var Stackie=function(){function n(b,a){function d(h,a,g){f[a*b+h]=g}function e(a){1<a&&(a=1);0>a&&(a=0);a=255*a&255;return a|a<<8|a<<16|4278190080}var f=new Float32Array(b*a);this.get=function(a,c){return f[c*b+a]};this.set=d;this.getImageData=function(d){d||(d=e);for(var c=new ImageData(b,a),g=new Uint32Array(c.data.buffer),k=0;k<g.length;k++)g[k]=d(f[k]);return c};this.generate=function(e){for(var c=0;c<a;c++)for(var g=0;g<b;g++)d(g,c,e(g/b,c/a))}}function p(b,a,d){function e(a){return function(){var b=
c.pop();c.push(a(c.pop(),b))}}function f(a){return function(){c.push(a(c.pop()))}}function h(a){return function(){c.push(a)}}var c=[];b={x:h(b),y:h(a),"*":e(function(a,b){return a*b}),"/":e(function(a,b){return a/b}),"-":e(function(a,b){return a-b}),"+":e(function(a,b){return a+b}),p:e(q),s:f(Math.sin),c:f(Math.cos),q:f(Math.sqrt),a:e(Math.atan2),r:f(Math.random),l:f(Math.log),"^":e(Math.pow),P:h(Math.PI),"~":f(Math.abs),"!":f(function(a){return 1-a}),d:function(){var a=c.pop();c.push(a);c.push(a)}};
for(a=0;10>a;a++)b[""+a]=h(a);for(a=0;a<d.length;a++)b[d[a]]();return c.pop()}function q(b,a){function d(a,b,c){c=c*c*c*(c*(6*c-15)+10);return(1-c)*a+c*b}function e(c,d){var e=2*(256*d+c);return(b-c)*m[e]+(a-d)*m[e+1]}b%=256;a%=256;var f=b&255,h=a&255,c=f+1&255,g=h+1&255,k=b-f,l=a-h;return d(d(e(f,h),e(c,h),k),d(e(f,g),e(c,g),k),l)}var l={},m=function(b,a){result=new Float32Array(b*a*2);for(var d=0;d<b*a*2;d+=2){var e=Math.random()*Math.PI*2;result[d]=Math.sin(e);result[d+1]=Math.cos(e)}return result}(256,
256);l.makeField=function(b,a){return new n(b,a)};l.program=function(b){return function(a,d){return p(a,d,b)}};return l}();