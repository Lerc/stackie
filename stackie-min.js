var Stackie=function(){function t(b){n=u(b);result=new Float32Array(131072);for(b=0;131072>b;b+=2){var a=n()*Math.PI*2;result[b]=Math.sin(a);result[b+1]=Math.cos(a)}p=result}function v(b,a){function c(a,c,f){e[c*b+a]=f}var e=new Float32Array(b*a),g=q("x");this.get=function(a,c){return e[c*b+a]};this.set=c;this.getImageData=function(c){c=c||g;for(var k=new ImageData(b,a),f=new Uint32Array(k.data.buffer),m=0;m<f.length;m++)f[m]=c(e[m]);return k};this.generate=function(d){for(var e=0;e<a;e++)for(var f=
0;f<b;f++)c(f,e,d(f/b,e/a))}}function w(){function b(b){d.push(b)}function a(a){return function(){var c=d.pop();b(a(d.pop(),c))}}function c(a){return function(){b(a(d.pop()))}}function e(a){return function(){b(a)}}function g(a){return function(){b(d[a])}}for(var d,k={x:g("x"),y:g("y"),t:g("t"),"*":a(function(b,a){return b*a}),"/":a(function(b,a){return b/a}),"-":a(function(b,a){return b-a}),"+":a(function(b,a){return b+a}),p:a(x),s:c(Math.sin),c:c(Math.cos),q:c(Math.sqrt),a:a(Math.atan2),r:c(n),"<":a(Math.min),
">":a(Math.max),l:c(Math.log),"^":a(Math.pow),P:e(Math.PI),"~":c(Math.abs),"!":c(function(b){return 1-b}),":":function(){var a=d.pop(),c=d.pop();b(a);b(c)},";":function(){var a=d.pop(),c=d.pop(),e=d.pop();b(a);b(c);b(e)},d:function(){var a=d.pop();b(a);b(a)}},f=0;10>f;f++)k[""+f]=e(f);return function(a,b){d=a;k[b]()}}function r(b){var a=w();return function(c,e,g){var d=[];d.x=c;d.y=e;d.t=g;for(c=0;c<b.length;c++)a(d,b[c]);return d.pop()}}function l(b){return Math.floor(255*(0>b?0:1<b?1:b))}function q(b){b=
r(b);var a=[];for(i=0;256>i;i++){var c=l(b(i/256,0)),e=l(b(i/256,.5)),g=l(b(i/256,1));a.push(g<<16|e<<8|c|4278190080)}return function(b){return a[l(b)]}}function x(b,a){function c(a,b,c){c=c*c*c*(c*(6*c-15)+10);return(1-c)*a+c*b}function e(c,d){var e=2*(256*d+c);return(b-c)*p[e]+(a-d)*p[e+1]}b%=256;a%=256;var g=b&255,d=a&255,k=g+1&255,f=d+1&255,h=b-g,l=a-d;return c(c(e(g,d),e(k,d),h),c(e(g,f),e(k,f),h),l)}function u(b){var a=b&4294967295,c=173;return function(){c=36969*(c&65535)+(c>>16);a=18E3*(a&
65535)+(a>>16);return((c<<16)+a&4294967295)/4294967296}}var h={},n,p;t(42);h.makeField=function(b,a){return new v(b,a)};h.program=r;h.makeRandom=u;h.setSeed=t;h.makePaletteMapper=q;h.generate=function(b,a,c){c=c||256;c=new v(c,c);a=q(a||"x");c.generate(r(b));return c.getImageData(a)};return h}();